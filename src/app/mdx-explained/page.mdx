---
title: "MDX Pipeline Explained"
description: "A comprehensive breakdown of how MDX integrates with Next.js App Router"
---

# MDX Pipeline Explained

This page documents our journey learning MDX in Next.js and explains the complete pipeline from development to production.

## What is MDX?

MDX is a **superset of Markdown** that allows you to write **JSX directly** in your markdown files. It combines:

- ğŸ“ **Markdown**: For content and formatting
- âš›ï¸ **React/JSX**: For interactive components
- ğŸ¨ **Custom Components**: For enhanced functionality

## The MDX Development Pipeline

### Development Mode (`npm run dev`)

```
1. Source File (page.mdx)
   â†“
2. File Watcher (Next.js dev server)
   â†“
3. MDX Loader (@mdx-js/loader)
   â†“
4. MDX â†’ JSX Transformation
   â†“
5. Component Injection (useMDXComponents)
   â†“
6. JSX â†’ JavaScript (Turbopack/Webpack)
   â†“
7. Hot Module Replacement (HMR)
   â†“
8. Browser Rendering
```

**Key Development Features:**

- âœ… **Hot Reload**: Changes reflect instantly
- âœ… **Error Overlay**: Real-time error feedback
- âœ… **Fast Refresh**: Component state preservation

### Production Build (`npm run build`)

```
1. Source File (page.mdx)
   â†“
2. Static Analysis & Tree Shaking
   â†“
3. MDX Compilation (@next/mdx)
   â†“
4. Component Resolution (mdx-components.tsx)
   â†“
5. Bundle Optimization
   â†“
6. Static Generation (if applicable)
   â†“
7. Optimized JavaScript Bundles
   â†“
8. Deployment Ready Assets
```

**Production Optimizations:**

- ğŸš€ **Bundle Splitting**: Smaller chunks for faster loading
- ğŸ“¦ **Tree Shaking**: Remove unused code
- ğŸ—œï¸ **Minification**: Compressed JavaScript
- ğŸ“Š **Static Generation**: Pre-rendered HTML when possible

## Regular Next.js vs MDX Pipeline Comparison

### Regular Page Component (page.tsx)

```typescript
// src/app/about/page.tsx
export default function About() {
  return (
    <div>
      <h1>About Us</h1>
      <p>This is a regular React component.</p>
    </div>
  );
}
```

**Pipeline:**

```
TypeScript â†’ JSX â†’ JavaScript â†’ Bundle
```

### MDX Page (page.mdx)

```mdx
---
title: "About Us"
---

# About Us

This is **MDX** with <span style={{ color: 'blue' }}>JSX</span> mixed in!

<CustomComponent prop="value" />
```

**Pipeline:**

```
MDX â†’ JSX â†’ Component Mapping â†’ JavaScript â†’ Bundle
```

## Required Files for MDX Integration

### 1. `next.config.ts` - Configuration

```typescript
import createMDX from "@next/mdx";

const withMDX = createMDX({
  extension: /\.mdx?$/,
});

const nextConfig = {
  pageExtensions: ["ts", "tsx", "js", "jsx", "md", "mdx"],
};

export default withMDX(nextConfig);
```

### 2. `src/mdx-components.tsx` - Component Mapping

```typescript
import type { MDXComponents } from "mdx/types";

export function useMDXComponents(components = {}): MDXComponents {
  return {
    // Custom component mappings go here
    ...components,
  };
}
```

### 3. `package.json` - Dependencies

```json
{
  "dependencies": {
    "@mdx-js/loader": "^3.1.1",
    "@next/mdx": "^15.5.2",
    "@mdx-js/react": "^3.1.1",
    "@types/mdx": "^2.0.13"
  }
}
```

## File Structure for MDX Pages

```
src/app/
â”œâ”€â”€ mdx-explained/
â”‚   â””â”€â”€ page.mdx          # /mdx-explained route
â”œâ”€â”€ mdx-example/
â”‚   â”œâ”€â”€ page.mdx          # /mdx-example route
â”‚   â””â”€â”€ layout.tsx        # Optional layout wrapper
â”œâ”€â”€ layout.tsx            # Root layout
â””â”€â”€ page.tsx              # / (home) route

src/
â””â”€â”€ mdx-components.tsx    # Required for MDX component mapping
```

## Key Learning Points

### 1. **File Convention Matters**

- âŒ `src/app/hello.mdx` â†’ No route created
- âœ… `src/app/hello/page.mdx` â†’ Creates `/hello` route

### 2. **Server vs Client Components**

- MDX pages are **Server Components** by default
- Custom components can be Server or Client as needed
- Use `"use client"` only when you need interactivity

### 3. **Automatic Integration**

- Next.js **automatically** finds and uses `mdx-components.tsx`
- No manual imports needed for the components file
- Component mappings are injected during compilation

### 4. **Development vs Production**

- **Dev**: Fast compilation with Turbopack, instant feedback
- **Production**: Optimized bundles, static generation where possible

## Common Pitfalls We Encountered

1. **Missing `mdx-components.tsx`**: Results in Context errors
2. **Wrong file structure**: `.mdx` files need to be `page.mdx` in folders
3. **Server/Client mismatch**: Adding `"use client"` unnecessarily
4. **TypeScript errors**: Missing `@types/mdx` package

## Performance Implications

### Development

- **CPU**: ~2-5% idle, ~15-25% during changes
- **RAM**: ~200-400MB for small projects
- **Hot Reload**: ~1-2 seconds for MDX changes

### Production

- **Bundle Size**: MDX adds minimal overhead (~10-20KB)
- **Runtime**: Server Components = faster initial load
- **SEO**: Excellent (pre-rendered HTML)

## Next Steps for Learning

1. **Add Custom Components**: Create reusable MDX components
2. **Syntax Highlighting**: Integrate Shiki or Prism for code blocks
3. **Frontmatter Processing**: Extract metadata for page headers
4. **Table of Contents**: Auto-generate navigation from headings
5. **Remark/Rehype Plugins**: Extend markdown processing

## Conclusion

MDX in Next.js provides a powerful way to create content-rich applications by combining the simplicity of Markdown with the power of React. The integration is seamless once you understand the file conventions and pipeline flow.

The key insight: **MDX is not just Markdown with JSX** - it's a complete compilation pipeline that transforms content into optimized React components at build time.
